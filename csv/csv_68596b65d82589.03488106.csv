"<!DOCTYPE html>"
"<html lang=""id"">"
<head>
"<meta charset=""UTF-8"" />"
"<meta name=""viewport"" content=""width=device-width, initial-scale=1"" />"
"<title>Sistem Manajemen Gudang Terintegrasi</title>"
<style>
"  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap');"
"  * {"
"    box-sizing: border-box;"
"  }"
"  body {"
"    font-family: 'Inter', sans-serif;"
"    background: #f4f7fa;"
"    margin: 0;"
"    padding: 20px;"
"    color: #222;"
"  }"
"  h1, h2 {"
"    font-weight: 600;"
"    margin-bottom: 0.5rem;"
"  }"
"  h1 {"
"    font-size: 2.4rem;"
"    color: #1e40af;"
"    margin-bottom: 1rem;"
"  }"
"  .container {"
"    max-width: 1100px;"
"    margin: 0 auto;"
"  }"
"  /* Menu styles */"
"  .menu {"
"    display: flex;"
"    flex-wrap: wrap;"
"    gap: 12px;"
"    margin-bottom: 30px;"
"  }"
"  .menu button {"
"    padding: 10px 24px;"
"    background-color: #3b82f6;"
"    border: none;"
"    border-radius: 10px;"
"    color: white;"
"    font-weight: 700;"
"    cursor: pointer;"
"    transition: background-color 0.3s ease;"
"    flex: 1 0 calc(25% - 12px);"
"    min-width: 180px;"
"  }"
"  .menu button:hover,"
"  .menu button.active {"
"    background-color: #2563eb;"
"  }"
"  /* Sections */"
"  .section {"
"    display: none;"
"    background: white;"
"    padding: 30px 40px;"
"    border-radius: 15px;"
"    box-shadow: 0 6px 18px rgb(0 0 0 / 0.08);"
"    margin-bottom: 40px;"
"  }"
"  .active {"
"    display: block;"
"  }"
"  /* Form Layout */"
"  form {"
"    display: grid;"
"    grid-template-columns: repeat(auto-fit,minmax(220px,1fr));"
"    gap: 20px 30px;"
"    align-items: end;"
"  }"
"  label {"
"    display: block;"
"    font-weight: 600;"
"    margin-bottom: 6px;"
"    color: #555;"
"  }"
"  input[type=""text""],"
"  input[type=""number""],"
"  input[type=""date""],"
"  select {"
"    width: 100%;"
"    padding: 10px 14px;"
"    border: 2px solid #ddd;"
"    border-radius: 8px;"
"    font-size: 1rem;"
"    transition: border-color 0.3s ease;"
"  }"
"  input[type=""text""]:focus,"
"  input[type=""number""]:focus,"
"  input[type=""date""]:focus,"
"  select:focus {"
"    border-color: #2563eb;"
"    outline: none;"
"  }"
"  button {"
"    padding: 15px 28px;"
"    background-color: #3b82f6;"
"    border: none;"
"    border-radius: 10px;"
"    color: white;"
"    font-weight: 700;"
"    font-size: 1rem;"
"    cursor: pointer;"
"    transition: background-color 0.3s ease;"
"  }"
"  button:hover:not(:disabled) {"
"    background-color: #1e40af;"
"  }"
"  button:disabled {"
"    background-color: #93c5fd;"
"    cursor: not-allowed;"
"  }"
"  .error {"
"    border-color: #ef4444 !important;"
"  }"
"  .error-message {"
"    color: #ef4444;"
"    font-size: 0.87rem;"
"    margin-top: 3px;"
"    font-style: italic;"
"  }"
"  /* Tables */"
"  table {"
"    width: 100%;"
"    border-collapse: collapse;"
"    margin-top: 15px;"
"    font-size: 0.9rem;"
"    border-radius: 10px;"
"    overflow: hidden;"
"    box-shadow: 0 2px 6px rgb(0 0 0 / 0.05);"
"  }"
"  thead {"
"    background-color: #3b82f6;"
"    color: white;"
"  }"
"  thead th {"
"    padding: 12px 15px;"
"    text-align: left;"
"  }"
"  tbody tr:nth-child(even) {"
"    background-color: #f9fafb;"
"  }"
"  tbody td {"
"    padding: 10px 15px;"
"    border-bottom: 1px solid #e5e7eb;"
"    vertical-align: middle;"
"  }"
"  .badge {"
"    display: inline-block;"
"    padding: 4px 14px;"
"    font-weight: 700;"
"    border-radius: 12px;"
"    font-size: 0.85rem;"
"    color: white;"
"    text-transform: uppercase;"
"    letter-spacing: 0.06em;"
"    user-select: none;"
"  }"
"  .badge.in {"
"    background-color: #22c55e;"
"  }"
"  .badge.out {"
"    background-color: #dc2626;"
"  }"
"  /* Stock indicator */"
"  .low-stock {"
"    color: #b91c1c;"
"    font-weight: 700;"
"    user-select: none;"
"  }"
"  .stock-table td.low {"
"    background-color: #fee2e2;"
"    color: #991b1b;"
"    font-weight: 600;"
"  }"
"  /* Filters */"
"  .filters {"
"    display: flex;"
"    flex-wrap: wrap;"
"    gap: 15px 30px;"
"    align-items: center;"
"    padding-top: 10px;"
"  }"
"  .filters > div {"
"    flex: 1 1 200px;"
"  }"
"  .filters > div > label {"
"    margin-bottom: 4px;"
"    display: block;"
"  }"
"  /* Stock edit modal */"
"  .modal {"
"    position: fixed;"
"    top: 0; left: 0; bottom: 0; right: 0;"
"    background: rgba(0,0,0,0.6);"
"    display: none;"
"    justify-content: center;"
"    align-items: center;"
"    z-index: 1050;"
"  }"
"  .modal.active {"
"    display: flex;"
"  }"
"  .modal-content {"
"    background: white;"
"    border-radius: 12px;"
"    padding: 28px 40px;"
"    max-width: 400px;"
"    width: 100%;"
"    box-shadow: 0 8px 24px rgba(0,0,0,0.15);"
"  }"
"  .modal-content h3 {"
"    margin-top: 0;"
"    margin-bottom: 1rem;"
"    color: #1e40af;"
"  }"
"  .modal-content label {"
"    font-weight: 600;"
"    margin-bottom: 6px;"
"    color: #444;"
"  }"
"  .modal-content input[type=""number""],"
"  .modal-content input[type=""text""]  {"
"    width: 100%;"
"    padding: 10px 14px;"
"    font-size: 1rem;"
"    border-radius: 8px;"
"    border: 2px solid #ddd;"
"    transition: border-color 0.3s ease;"
"    margin-bottom: 14px;"
"  }"
"  .modal-content input[type=""number""]:focus,"
"  .modal-content input[type=""text""]:focus {"
"    outline: none;"
"    border-color: #2563eb;"
"  }"
"  .modal-content button {"
"    width: 48%;"
"    margin-right: 4%;"
"  }"
"  .modal-content button:last-child {"
"    margin-right: 0;"
"    background-color: #ef4444;"
"  }"
"  /* Notification style */"
"  #notification-bar {"
"    position: fixed;"
"    top: 20px; right: 20px;"
"    background: #dc2626;"
"    color: white;"
"    padding: 15px 25px;"
"    border-radius: 12px;"
"    font-weight: 700;"
"    box-shadow: 0 6px 15px rgb(0 0 0 / 0.15);"
"    display: none;"
"    z-index: 1100;"
"  }"
"  /* Responsive */"
"  @media (max-width: 720px) {"
"    .menu button {"
"      flex: 1 0 100%;"
"    }"
"    form {"
"      grid-template-columns: 1fr !important;"
"    }"
"    .filters {"
"      flex-direction: column;"
"    }"
"  }"
</style>
</head>
<body>
"  <div class=""container"">"
"    <h1>Sistem Manajemen Gudang Terintegrasi</h1>"
"    <nav class=""menu"" role=""navigation"" aria-label=""Menu utama"">"
"      <button id=""menu-in-out"" class=""active"" aria-controls=""section-in-out"" aria-selected=""true"" role=""tab"">Pencatatan Barang Masuk/Keluar</button>"
"      <button id=""menu-stock-management"" aria-controls=""section-stock-management"" aria-selected=""false"" role=""tab"">Manajemen Data Stok</button>"
"      <button id=""menu-low-stock-notification"" aria-controls=""section-low-stock-notification"" aria-selected=""false"" role=""tab"">Notifikasi Stok Minimum</button>"
"      <button id=""menu-reports"" aria-controls=""section-reports"" aria-selected=""false"" role=""tab"">Laporan Stok dan Transaksi</button>"
"    </nav>"
"    <!-- Section 1: Pencatatan Barang Masuk dan Keluar -->"
"    <section id=""section-in-out"" class=""section active"" role=""tabpanel"" tabindex=""0"" aria-labelledby=""menu-in-out"">"
"      <h2>Pencatatan Barang Masuk dan Keluar</h2>"
"      <form id=""transaction-form"" novalidate aria-label=""Form pencatatan transaksi barang masuk dan keluar"">"
"        <div>"
"          <label for=""transaction-type"">Jenis Transaksi<span aria-hidden=""true"">*</span></label>"
"          <select id=""transaction-type"" name=""transactionType"" required aria-required=""true"" aria-describedby=""error-transaction-type"">"
"            <option value="""">-- Pilih Jenis Transaksi --</option>"
"            <option value=""in"">Barang Masuk</option>"
"            <option value=""out"">Barang Keluar</option>"
"          </select>"
"          <div id=""error-transaction-type"" class=""error-message"" aria-live=""polite""></div>"
"        </div>"
"        <div>"
"          <label for=""item-code"">Kode Barang<span aria-hidden=""true"">*</span></label>"
"          <input type=""text"" id=""item-code"" name=""itemCode"" required aria-required=""true"" aria-describedby=""error-item-code"" placeholder=""Contoh: BRG123"" autocomplete=""off"" />"
"          <div id=""error-item-code"" class=""error-message"" aria-live=""polite""></div>"
"        </div>"
"        <div>"
"          <label for=""item-name"">Nama Barang<span aria-hidden=""true"">*</span></label>"
"          <input type=""text"" id=""item-name"" name=""itemName"" required aria-required=""true"" aria-describedby=""error-item-name"" placeholder=""Contoh: Kabel"" autocomplete=""off"" />"
"          <div id=""error-item-name"" class=""error-message"" aria-live=""polite""></div>"
"        </div>"
"        <div>"
"          <label for=""category"">Kategori Barang<span aria-hidden=""true"">*</span></label>"
"          <input type=""text"" id=""category"" name=""category"" required aria-required=""true"" aria-describedby=""error-category"" placeholder=""Contoh: Elektronik"" autocomplete=""off"" />"
"          <div id=""error-category"" class=""error-message"" aria-live=""polite""></div>"
"        </div>        "
"        <div>"
"          <label for=""quantity"">Jumlah<span aria-hidden=""true"">*</span></label>"
"          <input type=""number"" id=""quantity"" name=""quantity"" required aria-required=""true"" aria-describedby=""error-quantity"" min=""1"" placeholder=""0"" />"
"          <div id=""error-quantity"" class=""error-message"" aria-live=""polite""></div>"
"        </div>"
"        <div>"
"          <label for=""unit"">Satuan<span aria-hidden=""true"">*</span></label>"
"          <input type=""text"" id=""unit"" name=""unit"" required aria-required=""true"" aria-describedby=""error-unit"" placeholder=""Contoh: pcs"" autocomplete=""off"" />"
"          <div id=""error-unit"" class=""error-message"" aria-live=""polite""></div>"
"        </div>"
"        <div>"
"          <label for=""transaction-date"">Tanggal Transaksi<span aria-hidden=""true"">*</span></label>"
"          <input type=""date"" id=""transaction-date"" name=""transactionDate"" required aria-required=""true"" aria-describedby=""error-transaction-date"" />"
"          <div id=""error-transaction-date"" class=""error-message"" aria-live=""polite""></div>"
"        </div>"
"        <div>"
"          <label for=""party"">Pihak Terkait<span aria-hidden=""true"">*</span></label>"
"          <input type=""text"" id=""party"" name=""party"" required aria-required=""true"" aria-describedby=""error-party"" placeholder=""Nama supplier atau penerima"" autocomplete=""off"" />"
"          <div id=""error-party"" class=""error-message"" aria-live=""polite""></div>"
"        </div>"
"        <div>"
"          <button type=""submit"" id=""submit-transaction"">Simpan Transaksi</button>"
"        </div>"
"      </form>"
"      <h3 style=""margin-top: 30px;"">Riwayat Transaksi</h3>"
"      <div class=""filters"" role=""region"" aria-label=""Filter riwayat transaksi"">"
"        <div>"
"          <label for=""filter-type"">Jenis Transaksi</label>"
"          <select id=""filter-type"" aria-controls=""transactions-table"">"
"            <option value="""">Semua</option>"
"            <option value=""in"">Barang Masuk</option>"
"            <option value=""out"">Barang Keluar</option>"
"          </select>"
"        </div>"
"        <div>"
"          <label for=""filter-item-name"">Nama Barang</label>"
"          <input type=""text"" id=""filter-item-name"" placeholder=""Cari nama barang..."" aria-controls=""transactions-table"" autocomplete=""off"" />"
"        </div>"
"        <div>"
"          <label for=""filter-date-from"">Tanggal Dari</label>"
"          <input type=""date"" id=""filter-date-from"" aria-controls=""transactions-table"" />"
"        </div>"
"        <div>"
"          <label for=""filter-date-to"">Tanggal Sampai</label>"
"          <input type=""date"" id=""filter-date-to"" aria-controls=""transactions-table"" />"
"        </div>"
"        <div style=""align-self: flex-end;"">"
"          <button id=""clear-filters-btn"" type=""button"" title=""Hapus semua filter"">Hapus Filter</button>"
"        </div>"
"      </div>"
"      <table id=""transactions-table"" aria-live=""polite"" aria-label=""Daftar riwayat transaksi"" class=""stock-table"">"
"        <thead>"
"          <tr>"
"            <th>Tanggal</th>"
"            <th>Kode Barang</th>"
"            <th>Nama Barang</th>"
"            <th>Kategori</th>"
"            <th>Jenis Transaksi</th>"
"            <th>Jumlah</th>"
"            <th>Satuan</th>"
"            <th>Pihak Terkait</th>"
"          </tr>"
"        </thead>"
"        <tbody>"
"          <!-- Transactions -->"
"        </tbody>"
"      </table>"
"    </section>"
"    <!-- Section 2: Manajemen Data Stok -->"
"    <section id=""section-stock-management"" class=""section"" role=""tabpanel"" tabindex=""0"" aria-labelledby=""menu-stock-management"">"
"      <h2>Manajemen Data Stok</h2>"
"      <p>Menampilkan daftar stok barang saat ini. Klik <strong>Edit</strong> untuk mengubah stok (supervisor).</p>"
"      <table id=""stock-table"" class=""stock-table"" aria-live=""polite"">"
"        <thead>"
"          <tr>"
"            <th>Kode Barang</th>"
"            <th>Nama Barang</th>"
"            <th>Kategori</th>"
"            <th>Jumlah Tersedia</th>"
"            <th>Satuan</th>"
"            <th>Stok Minimum</th>"
"            <th>Status</th>"
"            <th>Aksi</th>"
"          </tr>"
"        </thead>"
"        <tbody>"
"          <!-- Stock data -->"
"        </tbody>"
"      </table>"
"    </section>"
"    <!-- Section 3: Notifikasi Stok Minimum -->"
"    <section id=""section-low-stock-notification"" class=""section"" role=""tabpanel"" tabindex=""0"" aria-labelledby=""menu-low-stock-notification"">"
"      <h2>Notifikasi Stok Minimum</h2>"
"      <p>Daftar barang dengan stok di bawah atau mendekati batas minimum.</p>"
"      <table id=""low-stock-table"" class=""stock-table"" aria-live=""polite"">"
"        <thead>"
"          <tr>"
"            <th>Kode Barang</th>"
"            <th>Nama Barang</th>"
"            <th>Kategori</th>"
"            <th>Jumlah Tersedia</th>"
"            <th>Satuan</th>"
"            <th>Stok Minimum</th>"
"            <th>Status</th>"
"          </tr>"
"        </thead>"
"        <tbody>"
"          <!-- Low stock data -->"
"        </tbody>"
"      </table>"
"    </section>"
"    <!-- Section 4: Laporan Stok dan Transaksi -->"
"    <section id=""section-reports"" class=""section"" role=""tabpanel"" tabindex=""0"" aria-labelledby=""menu-reports"">"
"      <h2>Laporan Stok dan Transaksi</h2>"
"      <div class=""filters"" role=""region"" aria-label=""Filter laporan transaksi"">"
"        <div>"
"          <label for=""report-filter-date-from"">Tanggal Dari</label>"
"          <input type=""date"" id=""report-filter-date-from"" />"
"        </div>"
"        <div>"
"          <label for=""report-filter-date-to"">Tanggal Sampai</label>"
"          <input type=""date"" id=""report-filter-date-to"" />"
"        </div>"
"        <div>"
"          <label for=""report-filter-low-stock"">Tampilkan Barang Stok Rendah</label>"
"          <select id=""report-filter-low-stock"">"
"            <option value=""all"">Semua Barang</option>"
"            <option value=""low"">Stok Rendah Saja</option>"
"          </select>"
"        </div>"
"        <div style=""align-self: flex-end;"">"
"          <button id=""clear-report-filters-btn"" type=""button"" title=""Hapus semua filter laporan"">Hapus Filter</button>"
"        </div>"
"      </div>"
"      <h3>Riwayat Transaksi Filtered</h3>"
"      <table id=""report-transactions-table"" class=""stock-table"" aria-live=""polite"">"
"        <thead>"
"          <tr>"
"            <th>Tanggal</th>"
"            <th>Kode Barang</th>"
"            <th>Nama Barang</th>"
"            <th>Kategori</th>"
"            <th>Jenis Transaksi</th>"
"            <th>Jumlah</th>"
"            <th>Satuan</th>"
"            <th>Pihak Terkait</th>"
"          </tr>"
"        </thead>"
"        <tbody>"
"          <!-- Transaction reports -->"
"        </tbody>"
"      </table>"
"      <h3 style=""margin-top: 30px;"">Daftar Barang dengan Stok Rendah</h3>"
"      <table id=""report-low-stock-table"" class=""stock-table"" aria-live=""polite"">"
"        <thead>"
"          <tr>"
"            <th>Kode Barang</th>"
"            <th>Nama Barang</th>"
"            <th>Kategori</th>"
"            <th>Jumlah Tersedia</th>"
"            <th>Satuan</th>"
"            <th>Stok Minimum</th>"
"            <th>Status</th>"
"          </tr>"
"        </thead>"
"        <tbody>"
"          <!-- Low stock reports -->"
"        </tbody>"
"      </table>"
"    </section>"
"  </div>"
"  <!-- Modal for Manual Stock Edit -->"
"  <div id=""modal-stock-edit"" class=""modal"" role=""dialog"" aria-modal=""true"" aria-labelledby=""modal-title"" tabindex=""-1"">"
"    <div class=""modal-content"">"
"      <h3 id=""modal-title"">Edit Stok Manual (Supervisor)</h3>"
"      <form id=""stock-edit-form"" novalidate>"
"        <label for=""edit-stock-quantity"">Jumlah Stok Baru</label>"
"        <input type=""number"" id=""edit-stock-quantity"" required min=""0"" />"
"        <label for=""edit-stock-minimum"">Batas Stok Minimum</label>"
"        <input type=""number"" id=""edit-stock-minimum"" required min=""0"" />"
"        <div style=""display:flex; justify-content: flex-end; gap: 12px; margin-top: 20px;"">"
"          <button type=""submit"">Simpan</button>"
"          <button type=""button"" id=""stock-edit-cancel-btn"" style=""background: #ef4444;"">Batal</button>"
"        </div>"
"      </form>"
"    </div>"
"  </div>"
"  <!-- Notification Bar -->"
"  <div id=""notification-bar"" role=""alert"" aria-live=""assertive""></div>"
<script>
"  (() => {"
"    const menuButtons = {"
"      inOut: document.getElementById('menu-in-out'),"
"      stockManagement: document.getElementById('menu-stock-management'),"
"      lowStockNotification: document.getElementById('menu-low-stock-notification'),"
"      reports: document.getElementById('menu-reports')"
"    };"
"    const sections = {"
"      inOut: document.getElementById('section-in-out'),"
"      stockManagement: document.getElementById('section-stock-management'),"
"      lowStockNotification: document.getElementById('section-low-stock-notification'),"
"      reports: document.getElementById('section-reports'),"
"    };"
"    const notifBar = document.getElementById('notification-bar');"
"    const SHOW_NOTIFICATION = (msg, timeout = 3500) => {"
"      notifBar.textContent = msg;"
"      notifBar.style.display = 'block';"
"      setTimeout(() => (notifBar.style.display = 'none'), timeout);"
"    };"
"    const LS_TRANSACTIONS = 'wms_transactions';"
"    const LS_STOCK = 'wms_stock';"
"    // Initialize data with dummy values for demo"
"    let transactions = ["
"      {"
"        id: 1,"
"        transactionType: 'in',"
"        itemCode: 'BRG001',"
"        itemName: 'Kabel HDMI',"
"        category: 'Elektronik',"
"        quantity: 50,"
"        unit: 'pcs',"
"        transactionDate: '2024-06-01',"
"        party: 'Supplier ABC'"
"      },"
"      {"
"        id: 2,"
"        transactionType: 'in',"
"        itemCode: 'BRG002',"
"        itemName: 'Mouse Wireless',"
"        category: 'Elektronik',"
"        quantity: 30,"
"        unit: 'pcs',"
"        transactionDate: '2024-06-02',"
"        party: 'Supplier XYZ'"
"      },"
"      {"
"        id: 3,"
"        transactionType: 'out',"
"        itemCode: 'BRG001',"
"        itemName: 'Kabel HDMI',"
"        category: 'Elektronik',"
"        quantity: 10,"
"        unit: 'pcs',"
"        transactionDate: '2024-06-03',"
"        party: 'Pelanggan PT. Maju'"
"      },"
"      {"
"        id: 4,"
"        transactionType: 'in',"
"        itemCode: 'BRG003',"
"        itemName: 'Sekring 5A',"
"        category: 'Listrik',"
"        quantity: 100,"
"        unit: 'pcs',"
"        transactionDate: '2024-06-04',"
"        party: 'Supplier DEF'"
"      },"
"      {"
"        id: 5,"
"        transactionType: 'out',"
"        itemCode: 'BRG002',"
"        itemName: 'Mouse Wireless',"
"        category: 'Elektronik',"
"        quantity: 5,"
"        unit: 'pcs',"
"        transactionDate: '2024-06-05',"
"        party: 'Pelanggan PT. Jaya'"
"      }"
"    ];"
"    let stock = {"
"      'BRG001': {"
"        name: 'Kabel HDMI',"
"        category: 'Elektronik',"
"        unit: 'pcs',"
"        quantity: 40,  // 50 in - 10 out"
"        minStock: 15"
"      },"
"      'BRG002': {"
"        name: 'Mouse Wireless',"
"        category: 'Elektronik',"
"        unit: 'pcs',"
"        quantity: 25,  // 30 in - 5 out"
"        minStock: 10"
"      },"
"      'BRG003': {"
"        name: 'Sekring 5A',"
"        category: 'Listrik',"
"        unit: 'pcs',"
"        quantity: 100, // 100 in no out"
"        minStock: 20"
"      }"
"    };"
"    let isSupervisor = false;"
"    function saveData() {"
"      localStorage.setItem(LS_TRANSACTIONS, JSON.stringify(transactions));"
"      localStorage.setItem(LS_STOCK, JSON.stringify(stock));"
"    }"
"    function loadData() {"
"      const txData = localStorage.getItem(LS_TRANSACTIONS);"
"      const stData = localStorage.getItem(LS_STOCK);"
"      if(txData && stData) {"
"        transactions = JSON.parse(txData);"
"        stock = JSON.parse(stData);"
"      }"
"    }"
"    function formatDate(dateStr) {"
"      const d = new Date(dateStr);"
"      if (isNaN(d)) return '';"
"      return d.toLocaleDateString('id-ID', {"
"        day: '2-digit',"
"        month: 'short',"
"        year: 'numeric'"
"      });"
"    }"
"    function isLowStock(item) {"
"      return item.quantity <= item.minStock;"
"    }"
"    function setActiveMenu(menuKey) {"
"      Object.keys(menuButtons).forEach(k => {"
"        if (k === menuKey) {"
"          menuButtons[k].classList.add('active');"
"          menuButtons[k].setAttribute('aria-selected', 'true');"
"          sections[k].classList.add('active');"
"          sections[k].focus();"
"        } else {"
"          menuButtons[k].classList.remove('active');"
"          menuButtons[k].setAttribute('aria-selected', 'false');"
"          sections[k].classList.remove('active');"
"        }"
"      });"
"    }"
"    menuButtons.inOut.addEventListener('click', () => {"
"      setActiveMenu('inOut');"
"      renderTransactionHistory();"
"    });"
"    menuButtons.stockManagement.addEventListener('click', () => {"
"      setActiveMenu('stockManagement');"
"      renderStockManagement();"
"    });"
"    menuButtons.lowStockNotification.addEventListener('click', () => {"
"      setActiveMenu('lowStockNotification');"
"      renderLowStockNotifications();"
"    });"
"    menuButtons.reports.addEventListener('click', () => {"
"      setActiveMenu('reports');"
"      renderReportTransactions();"
"      renderReportLowStock();"
"    });"
"    function showError(id, message) {"
"      const input = document.getElementById(id);"
"      const err = document.getElementById('error-' + id);"
"      if (input && err) {"
"        input.classList.add('error');"
"        err.textContent = message;"
"      }"
"    }"
"    function clearError(id) {"
"      const input = document.getElementById(id);"
"      const err = document.getElementById('error-' + id);"
"      if (input && err) {"
"        input.classList.remove('error');"
"        err.textContent = '';"
"      }"
"    }"
"    function validateTransactionForm() {"
"      let valid = true;"
"      const requiredFields = ["
"        'transaction-type',"
"        'item-code',"
"        'item-name',"
"        'category',"
"        'quantity',"
"        'unit',"
"        'transaction-date',"
"        'party'"
"      ];"
"      for (const id of requiredFields) {"
"        const el = document.getElementById(id);"
"        if (!el.value || (el.type === 'number' && el.value <= 0)) {"
"          showError(id, 'Wajib diisi dan valid');"
"          valid = false;"
"        } else {"
"          clearError(id);"
"        }"
"      }"
"      return valid;"
"    }"
"    function updateStockForTransaction(tx) {"
"      const code = tx.itemCode.trim();"
"      if (!stock[code]) {"
"        stock[code] = {"
"          name: tx.itemName.trim(),"
"          category: tx.category.trim(),"
"          unit: tx.unit.trim(),"
"          quantity: 0,"
"          minStock: 5"
"        };"
"      }"
"      if (tx.transactionType === 'in') {"
"        stock[code].quantity += tx.quantity;"
"      } else if (tx.transactionType === 'out') {"
"        stock[code].quantity -= tx.quantity;"
"        if (stock[code].quantity < 0) stock[code].quantity = 0;"
"      }"
"    }"
"    function renderTransactionHistory(filterParams = null) {"
"      const tbody = document.querySelector('#transactions-table tbody');"
"      tbody.innerHTML = '';"
"      let filtered = transactions.slice();"
"      if (!filterParams) {"
"        const filterType = document.getElementById('filter-type').value;"
"        const filterItemName = document.getElementById('filter-item-name').value.trim().toLowerCase();"
"        const filterDateFrom = document.getElementById('filter-date-from').value;"
"        const filterDateTo = document.getElementById('filter-date-to').value;"
"        filterParams = { filterType, filterItemName, filterDateFrom, filterDateTo };"
"      }"
"      filtered = filtered.filter(tx => {"
"        if (filterParams.filterType && tx.transactionType !== filterParams.filterType) return false;"
"        if (filterParams.filterItemName && !tx.itemName.toLowerCase().includes(filterParams.filterItemName)) return false;"
"        if (filterParams.filterDateFrom && new Date(tx.transactionDate) < new Date(filterParams.filterDateFrom)) return false;"
"        if (filterParams.filterDateTo && new Date(tx.transactionDate) > new Date(filterParams.filterDateTo)) return false;"
"        return true;"
"      });"
"      filtered.sort((a,b) => new Date(a.transactionDate) - new Date(b.transactionDate));"
"      if (filtered.length === 0) {"
"        tbody.innerHTML = '<tr><td colspan=""8"" style=""text-align:center; font-style: italic;"">Tidak ada data transaksi.</td></tr>';"
"        return;"
"      }"
"      for (const tx of filtered) {"
"        const tr = document.createElement('tr');"
"        tr.innerHTML = `"
"          <td>${formatDate(tx.transactionDate)}</td>"
"          <td>${tx.itemCode}</td>"
"          <td>${tx.itemName}</td>"
"          <td>${tx.category}</td>"
"          <td><span class=""badge ${tx.transactionType}"">${tx.transactionType === 'in' ? 'Barang Masuk' : 'Barang Keluar'}</span></td>"
"          <td>${tx.quantity}</td>"
"          <td>${tx.unit}</td>"
"          <td>${tx.party}</td>"
"        `;"
"        tbody.appendChild(tr);"
"      }"
"    }"
"    const formTransaction = document.getElementById('transaction-form');"
"    formTransaction.addEventListener('submit', e => {"
"      e.preventDefault();"
"      if (!validateTransactionForm()) return;"
"      const txType = document.getElementById('transaction-type').value;"
"      const itemCode = document.getElementById('item-code').value.trim();"
"      const itemName = document.getElementById('item-name').value.trim();"
"      const category = document.getElementById('category').value.trim();"
"      const quantity = parseInt(document.getElementById('quantity').value);"
"      const unit = document.getElementById('unit').value.trim();"
"      const date = document.getElementById('transaction-date').value;"
"      const party = document.getElementById('party').value.trim();"
"      if (txType === 'out') {"
"        const currentStockQty = stock[itemCode]?.quantity || 0;"
"        if (quantity > currentStockQty) {"
"          alert(`Stok tidak cukup! Stok saat ini untuk ${itemCode} adalah ${currentStockQty}.`);"
"          return;"
"        }"
"      }"
"      const newTx = {"
"        id: Date.now(),"
"        transactionType: txType,"
"        itemCode,"
"        itemName,"
"        category,"
"        quantity,"
"        unit,"
"        transactionDate: date,"
"        party"
"      };"
"      transactions.push(newTx);"
"      updateStockForTransaction(newTx);"
"      saveData();"
"      renderTransactionHistory();"
"      renderStockManagement();"
"      renderLowStockNotifications();"
"      renderReportTransactions();"
"      renderReportLowStock();"
"      formTransaction.reset();"
"      document.getElementById('transaction-type').focus();"
"      SHOW_NOTIFICATION('Transaksi berhasil disimpan.');"
"    });"
"    ['filter-type', 'filter-item-name', 'filter-date-from', 'filter-date-to'].forEach(id => {"
"      const el = document.getElementById(id);"
"      if (el) {"
"        el.addEventListener('input', () => renderTransactionHistory());"
"      }"
"    });"
"    document.getElementById('clear-filters-btn').addEventListener('click', () => {"
"      ['filter-type', 'filter-item-name', 'filter-date-from', 'filter-date-to'].forEach(id => {"
"        const el = document.getElementById(id);"
"        if (el) el.value = '';"
"      });"
"      renderTransactionHistory();"
"    });"
"    const stockTableBody = document.querySelector('#stock-table tbody');"
"    function renderStockManagement() {"
"      stockTableBody.innerHTML = '';"
"      const codes = Object.keys(stock).sort();"
"      if(codes.length === 0) {"
"        stockTableBody.innerHTML = '<tr><td colspan=""8"" style=""text-align:center; font-style: italic;"">Belum ada data stok.</td></tr>';"
"        return;"
"      }"
"      for (const code of codes) {"
"        const item = stock[code];"
"        const tr = document.createElement('tr');"
"        tr.innerHTML = `"
"          <td>${code}</td>"
"          <td>${item.name}</td>"
"          <td>${item.category}</td>"
"          <td class=""${isLowStock(item) ? 'low' : ''}"">${item.quantity}</td>"
"          <td>${item.unit}</td>"
"          <td>${item.minStock}</td>"
"          <td>${isLowStock(item) ? '<span class=""low-stock"">Stok Rendah</span>' : '<span style=""color:#15803d; font-weight:700;"">Cukup</span>'}</td>"
"          <td><button class=""btn-edit-stock"" data-itemcode=""${code}"" aria-label=""Edit stok untuk ${item.name}"">Edit</button></td>"
"        `;"
"        stockTableBody.appendChild(tr);"
"      }"
"      document.querySelectorAll('.btn-edit-stock').forEach(btn => {"
"        btn.onclick = () => {"
"          const itemCode = btn.getAttribute('data-itemcode');"
"          requestSupervisorAccess(() => {"
"            openStockEditModal(itemCode);"
"          });"
"        };"
"      });"
"    }"
"    const lowStockTableBody = document.querySelector('#low-stock-table tbody');"
"    function renderLowStockNotifications() {"
"      lowStockTableBody.innerHTML = '';"
"      const lowStockItems = Object.entries(stock).filter(([_, item]) => isLowStock(item));"
"      if (lowStockItems.length === 0) {"
"        lowStockTableBody.innerHTML = '<tr><td colspan=""7"" style=""text-align:center; font-style: italic;"">Tidak ada barang dengan stok rendah.</td></tr>';"
"        return;"
"      }"
"      for (const [code, item] of lowStockItems) {"
"        const tr = document.createElement('tr');"
"        tr.innerHTML = `"
"          <td>${code}</td>"
"          <td>${item.name}</td>"
"          <td>${item.category}</td>"
"          <td>${item.quantity}</td>"
"          <td>${item.unit}</td>"
"          <td>${item.minStock}</td>"
"          <td><span class=""low-stock"">Stok Rendah</span></td>"
"        `;"
"        lowStockTableBody.appendChild(tr);"
"      }"
"    }"
"    const reportTransactionTableBody = document.querySelector('#report-transactions-table tbody');"
"    const reportLowStockTableBody = document.querySelector('#report-low-stock-table tbody');"
"    function renderReportTransactions() {"
"      const dateFrom = document.getElementById('report-filter-date-from').value;"
"      const dateTo = document.getElementById('report-filter-date-to').value;"
"      let filteredTx = transactions.slice();"
"      if (dateFrom) {"
"        filteredTx = filteredTx.filter(tx => new Date(tx.transactionDate) >= new Date(dateFrom));"
"      }"
"      if (dateTo) {"
"        filteredTx = filteredTx.filter(tx => new Date(tx.transactionDate) <= new Date(dateTo));"
"      }"
"      filteredTx.sort((a,b) => new Date(a.transactionDate) - new Date(b.transactionDate));"
"      reportTransactionTableBody.innerHTML = '';"
"      if (filteredTx.length === 0) {"
"        reportTransactionTableBody.innerHTML = '<tr><td colspan=""8"" style=""text-align:center; font-style: italic;"">Tidak ada transaksi dalam rentang tanggal tersebut.</td></tr>';"
"        return;"
"      }"
"      for (const tx of filteredTx) {"
"        const tr = document.createElement('tr');"
"        tr.innerHTML = `"
"          <td>${formatDate(tx.transactionDate)}</td>"
"          <td>${tx.itemCode}</td>"
"          <td>${tx.itemName}</td>"
"          <td>${tx.category}</td>"
"          <td><span class=""badge ${tx.transactionType}"">${tx.transactionType === 'in' ? 'Barang Masuk' : 'Barang Keluar'}</span></td>"
"          <td>${tx.quantity}</td>"
"          <td>${tx.unit}</td>"
"          <td>${tx.party}</td>"
"        `;"
"        reportTransactionTableBody.appendChild(tr);"
"      }"
"    }"
"    function renderReportLowStock() {"
"      const lowStockFilter = document.getElementById('report-filter-low-stock').value;"
"      let itemsToShow = Object.entries(stock);"
"      if (lowStockFilter === 'low') {"
"        itemsToShow = itemsToShow.filter(([_, item]) => isLowStock(item));"
"      }"
"      reportLowStockTableBody.innerHTML = '';"
"      if (itemsToShow.length === 0) {"
"        reportLowStockTableBody.innerHTML = '<tr><td colspan=""7"" style=""text-align:center; font-style: italic;"">Tidak ada data barang.</td></tr>';"
"        return;"
"      }"
"      for (const [code, item] of itemsToShow) {"
"        const tr = document.createElement('tr');"
"        tr.innerHTML = `"
"          <td>${code}</td>"
"          <td>${item.name}</td>"
"          <td>${item.category}</td>"
"          <td>${item.quantity}</td>"
"          <td>${item.unit}</td>"
"          <td>${item.minStock}</td>"
"          <td>${isLowStock(item) ? '<span class=""low-stock"">Stok Rendah</span>' : '<span style=""color:#15803d; font-weight:700;"">Cukup</span>'}</td>"
"        `;"
"        reportLowStockTableBody.appendChild(tr);"
"      }"
"    }"
"    document.getElementById('report-filter-date-from').addEventListener('input', () => {"
"      renderReportTransactions();"
"    });"
"    document.getElementById('report-filter-date-to').addEventListener('input', () => {"
"      renderReportTransactions();"
"    });"
"    document.getElementById('report-filter-low-stock').addEventListener('change', () => {"
"      renderReportLowStock();"
"      renderReportTransactions();"
"    });"
"    document.getElementById('clear-report-filters-btn').addEventListener('click', () => {"
"      document.getElementById('report-filter-date-from').value = '';"
"      document.getElementById('report-filter-date-to').value = '';"
"      document.getElementById('report-filter-low-stock').value = 'all';"
"      renderReportTransactions();"
"      renderReportLowStock();"
"    });"
"    async function requestSupervisorAccess(successCallback) {"
"      if (isSupervisor) {"
"        successCallback();"
"        return;"
"      }"
"      const password = prompt(""Masukkan password supervisor untuk mengedit stok:"");"
"      if (password === 'supervisor123') {"
"        isSupervisor = true;"
"        SHOW_NOTIFICATION(""Berhasil masuk sebagai supervisor."");"
"        successCallback();"
"      } else {"
"        alert(""Password salah. Akses ditolak."");"
"      }"
"    }"
"    const modal = document.getElementById('modal-stock-edit');"
"    const stockEditForm = document.getElementById('stock-edit-form');"
"    const editStockQtyInput = document.getElementById('edit-stock-quantity');"
"    const editStockMinInput = document.getElementById('edit-stock-minimum');"
"    const cancelBtn = document.getElementById('stock-edit-cancel-btn');"
"    let currentEditItemCode = null;"
"    function openStockEditModal(itemCode) {"
"      currentEditItemCode = itemCode;"
"      const item = stock[itemCode];"
"      if (!item) return;"
"      editStockQtyInput.value = item.quantity;"
"      editStockMinInput.value = item.minStock;"
"      modal.classList.add('active');"
"      editStockQtyInput.focus();"
"    }"
"    function closeStockEditModal() {"
"      modal.classList.remove('active');"
"      currentEditItemCode = null;"
"    }"
"    cancelBtn.addEventListener('click', () => closeStockEditModal());"
"    modal.addEventListener('click', e => {"
"      if (e.target === modal) closeStockEditModal();"
"    });"
"    stockEditForm.addEventListener('submit', e => {"
"      e.preventDefault();"
"      const newQty = parseInt(editStockQtyInput.value);"
"      const newMin = parseInt(editStockMinInput.value);"
"      if (isNaN(newQty) || newQty < 0) {"
"        alert(""Jumlah stok harus angka >= 0."");"
"        editStockQtyInput.focus();"
"        return;"
"      }"
"      if (isNaN(newMin) || newMin < 0) {"
"        alert(""Batas stok minimum harus angka >= 0."");"
"        editStockMinInput.focus();"
"        return;"
"      }"
"      const item = stock[currentEditItemCode];"
"      if (!item) {"
"        alert(""Data barang tidak ditemukan."");"
"        closeStockEditModal();"
"        return;"
"      }"
"      item.quantity = newQty;"
"      item.minStock = newMin;"
"      saveData();"
"      renderStockManagement();"
"      renderLowStockNotifications();"
"      renderReportLowStock();"
"      renderReportTransactions();"
"      closeStockEditModal();"
"      SHOW_NOTIFICATION(`Stok untuk ${item.name} berhasil diubah secara manual.`);"
"    });"
"    function setDateMaxToToday() {"
"      const today = new Date().toISOString().slice(0,10);"
"      document.getElementById('transaction-date').max = today;"
"      document.getElementById('filter-date-from').max = today;"
"      document.getElementById('filter-date-to').max = today;"
"      document.getElementById('report-filter-date-from').max = today;"
"      document.getElementById('report-filter-date-to').max = today;"
"    }"
"    function init() {"
"      loadData();"
"      setDateMaxToToday();"
"      renderTransactionHistory();"
"      renderStockManagement();"
"      renderLowStockNotifications();"
"      renderReportTransactions();"
"      renderReportLowStock();"
"    }"
"    init();"
"  })();"
</script>
</body>
</html>
